ifelse(is.na(b6), paste(b4, b5, sep='_'),
ifelse(is.na(b7), paste(b5, b6, sep='_'),
ifelse(is.na(b8), paste(b6, b7, sep='_'),
ifelse(is.na(b9), paste(b7, b8, sep='_'), paste(b8, b9, sep='_'))))))) %>%
select(-b1, -b2, -b3, -b4, -b5, -b6, -b7, -b8, -b9, -cell, -t)
rct_rarefyID_estimate <- bind_rows(
rlm_clm_txa_rarefyID_estimate %>%
filter(model=='Jtu_new_norm' | model=='S_pois_new') %>%
separate(level, into = c('Realm', 'Climate', 'Taxa', 'STUDY_ID', 'b5' , 'b6'), sep = '_', remove = FALSE) %>%
unite(rarefyID, b5, b6))
r1 = bt_rarefyid_coef %>%
filter(model!='Jne_new_norm') %>%
mutate(bt_slope = Estimate.cYEAR,
bt_upper = upper_slope,
bt_lower = lower_slope) %>%
select(rarefyID, model, bt_slope, bt_upper, bt_lower) %>%
inner_join(rarefied_medians %>% distinct(Biome, rarefyID),
by = 'rarefyID') %>%
inner_join(realm_climate_biome %>%
select(-REALM),
by = 'Biome')
r2 = rct_rarefyID_estimate %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope,
climate_mod = Climate) %>%
select(climate_mod, rarefyID, model, rct_slope, rct_lower, rct_upper)
cell_compare <- inner_join(r1, r2, by = c('model', 'rarefyID', 'climate_mod'))
cell_compare %>%
# separate(rarefyID, into = c('STUDY_ID', 'cell'), remove = F) %>%
# # want to see single versus multi-celled estimates
# group_by(STUDY_ID) %>%
# mutate(one.cell = ifelse(n_distinct(cell)==1,'1','>1')) %>%
# ungroup() %>%
ggplot() +
# facet_wrap(~model, scales = 'free') +
geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
alpha = 0.2,
size = 1,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Cell-level slope (RCT model)',
y = 'Cell-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
cell_compare
cell_compare %>% distinct(model)
cell_compare <- inner_join(r1, r2, by = c('model', 'rarefyID'))
cell_compare %>%
# separate(rarefyID, into = c('STUDY_ID', 'cell'), remove = F) %>%
# # want to see single versus multi-celled estimates
# group_by(STUDY_ID) %>%
# mutate(one.cell = ifelse(n_distinct(cell)==1,'1','>1')) %>%
# ungroup() %>%
ggplot() +
# facet_wrap(~model, scales = 'free') +
geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
alpha = 0.2,
size = 1,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Cell-level slope (RCT model)',
y = 'Cell-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
rct_rarefyID_estimate
rct_rarefyID_estimate %>% distinct(model)
ls()
# want to compare the slope estimates for studies and rarefyID's from
# the bt versus the rct models
rm(list=ls())
library(tidyverse)
load('~/Dropbox/1current/BioTime/local_code/hierarchical/6results/bt/model_coefs_ranefs/BTRfyID_coef_ranef_inclNewModel.Rdata')
load('~/Desktop/revision_models/rlm_clm_txa_old&new_modelCoefs.Rdata')
ls()
rlm_clm_txa_rarefyID_estimate
rlm_clm_txa_rarefyID_estimate %>% summarise(min(Estimate.cYEAR))
rlm_clm_txa_rarefyID_estimate %>% filter(Estimate.cYEAR < -0.5)
s1
rarefied_medians <- rarefied_medians %>%
group_by(Biome, taxa_mod) %>%
mutate(n_cells = n_distinct(rarefyID)) %>%
ungroup() %>%
filter(n_cells > 3)
#--------rarefied_medians.Rdata for meta data not in model object
load('~/Dropbox/BiogeoBioTIME/rarefied_medians.Rdata')
rarefied_medians <- rarefied_medians %>%
group_by(Biome, taxa_mod) %>%
mutate(n_cells = n_distinct(rarefyID)) %>%
ungroup() %>%
filter(n_cells > 3)
realm_climate_biome <- rarefied_medians %>%
distinct(REALM, climate_mod, Biome) %>%
ungroup()
# want unique climate (latitudinal bands for each biome)
realm_climate_biome <- realm_climate_biome %>%
# filter(Biome %in% biome_levels_model$Biome) %>%
mutate(climate_mod = ifelse(Biome=='Arctic', 'Polar',
ifelse(Biome=='Boreal_Forests_Taiga', 'Temperate',
ifelse(Biome=='Cold_Temperate_Northeast_Pacific', 'Temperate',
ifelse(Biome=='Continental_High_Antarctic', 'Polar',
ifelse(Biome=='Hawaii', 'Tropical',
ifelse(Biome=='Northern_European_Seas', 'Temperate',
ifelse(Biome=='Subantarctic_Islands', 'Polar',
ifelse(Biome=='Tropical_and_Subtropical_Grasslands_Savannas_and_Shrublands', 'Temperate',
ifelse(Biome=='Tropical_and_Subtropical_Moist_Broadleaf_Forests', 'Tropical',
ifelse(Biome=='Tropical_Northwestern_Atlantic', 'Tropical',
ifelse(Biome=='Northeast_Australian_Shelf', 'Tropical', climate_mod))))))))))))
# get the study level estimates
BT_study_estimate <- BT_studyID_estimate %>%
mutate(STUDY_ID2 = str_sub(level, start = -3),
# drop underscores
STUDY_ID = sub('_','', STUDY_ID2),
# remove study
bt = str_remove(level, STUDY_ID2),
# remove trailing underscore
bt = sub('_$', '', bt)) %>%
# ok, now use existing hacky code to separate biome and taxa
separate(bt, c('b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 't'), remove=F, sep='_') %>%
mutate(taxa_mod = ifelse(!is.na(t), t,
ifelse(!is.na(b7), b7,
ifelse(!is.na(b6), b6,
ifelse(!is.na(b5), b5,
ifelse(!is.na(b4), b4,
ifelse(!is.na(b3), b3, b2)))))),
b7 = ifelse(b7==taxa_mod, '', b7),
Biome = ifelse(is.na(b3), b1,
ifelse(is.na(b4), paste(b1, b2, sep='_'),
ifelse(is.na(b5), paste(b1, b2, b3, sep='_'),
ifelse(is.na(b6), paste(b1, b2, b3, b4, sep='_'),
ifelse(is.na(b7), paste(b1, b2, b3, b4, b5, sep='_'),
paste(b1, b2, b3, b4, b5, b6, b7, sep='_'))))))) %>%
select(-b1, -b2, -b3, -b4, -b5, -b6, -b7, -t)
# note there are only 291 study-level estimates for this model (cf. 321 for bt)
rct_study_estimate <- rlm_clm_txa_studyID_estimate %>%
separate(level, into = c('Realm', 'Climate', 'Taxa', 'STUDY_ID', 'b5' , 'b6'), sep = '_', remove = FALSE) %>%
select(-b5, -b6)
s1 <- BT_study_estimate %>%
filter(model!='Jne_new_norm' & model!='Jtu_beta') %>%
mutate(bt_slope = Estimate.cYEAR,
bt_upper = upper_slope,
bt_lower = lower_slope) %>%
select(Biome, STUDY_ID, model, bt_slope, bt_upper, bt_lower) %>%
inner_join(realm_climate_biome %>%
select(-REALM),
by = 'Biome')
s2 <- rct_study_estimate %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope,
climate_mod = Climate) %>%
select(climate_mod, STUDY_ID, model, rct_slope, rct_lower, rct_upper)
s1
rct_study_estimate
rct_study_estimate %>% distinct(model)
rct_study_estimate %>% distinct(time_period)
BT_study_estimate
BT_study_estimate %>% distinct(time_period)
s2 <- rct_study_estimate %>%
filter(model!='Jne_new_norm' & time_period=='ALL') %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope,
climate_mod = Climate) %>%
select(climate_mod, STUDY_ID, model, rct_slope, rct_lower, rct_upper)
study_compare <- inner_join(s1, s2, by = c("climate_mod", "STUDY_ID", 'model'))
study_compare %>%
ggplot() +
geom_linerange(aes(x = rct_slope, ymin = bt_lower, ymax = bt_upper, colour = model),
alpha = 0.2, size = .8) +
geom_errorbarh(aes(xmin = rct_lower, xmax = rct_upper, colour = model,
y = bt_slope),
height = 0, alpha = 0.2, size = .8) +
geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
alpha = 0.5,
size = 2,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Study-level slope (RCT model)',
y = 'Study-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
# want to compare the slope estimates for studies and rarefyID's from
# the bt versus the rct models
rm(list=ls())
library(tidyverse)
# biome-taxa model
load('~/Dropbox/1current/BioTime/local_code/hierarchical/6results/bt/model_coefs_ranefs/BTRfyID_coef_ranef_inclNewModel.Rdata')
# realm-climate-taxa model
load('~/Desktop/revision_models/rlm_clm_txa_old&new_modelCoefs.Rdata')
# realm-region-taxa model
load('~/Dropbox/1current/BioTime/local_code/hierarchical/6results/ct/rlm_reg_txa_coef_ranef.Rdata')
# wrangle study level estimates
BT_study_estimate <- BT_studyID_estimate %>%
mutate(STUDY_ID2 = str_sub(level, start = -3),
# drop underscores
STUDY_ID = sub('_','', STUDY_ID2),
# remove study
bt = str_remove(level, STUDY_ID2),
# remove trailing underscore
bt = sub('_$', '', bt)) %>%
# ok, now use existing hacky code to separate biome and taxa
separate(bt, c('b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 't'), remove=F, sep='_') %>%
mutate(taxa_mod = ifelse(!is.na(t), t,
ifelse(!is.na(b7), b7,
ifelse(!is.na(b6), b6,
ifelse(!is.na(b5), b5,
ifelse(!is.na(b4), b4,
ifelse(!is.na(b3), b3, b2)))))),
b7 = ifelse(b7==taxa_mod, '', b7),
Biome = ifelse(is.na(b3), b1,
ifelse(is.na(b4), paste(b1, b2, sep='_'),
ifelse(is.na(b5), paste(b1, b2, b3, sep='_'),
ifelse(is.na(b6), paste(b1, b2, b3, b4, sep='_'),
ifelse(is.na(b7), paste(b1, b2, b3, b4, b5, sep='_'),
paste(b1, b2, b3, b4, b5, b6, b7, sep='_'))))))) %>%
select(-b1, -b2, -b3, -b4, -b5, -b6, -b7, -t)
# repeat for realm-climate-taxa model (note different number of studies due to inclusion criteria)
rct_study_estimate <- rlm_clm_txa_studyID_estimate %>%
separate(level, into = c('Realm', 'Climate', 'Taxa', 'STUDY_ID', 'b5' , 'b6'), sep = '_', remove = FALSE) %>%
select(-b5, -b6)
# repeat for realm-region-taxa model (note different number of studies due to inclusion criteria)
rrt_study_estimate <- rrt_studyID_estimate %>%
# separate on the last (rightmost) underscore
separate(level, c('realm_region_taxa', 'STUDY_ID'), sep = '_(?!.*_)',
remove = F)
# prepare coefficients for joining
s1 <- BT_study_estimate %>%
filter(model!='Jne_new_norm' & model!='Jtu_beta') %>%
mutate(bt_slope = Estimate.cYEAR,
bt_upper = upper_slope,
bt_lower = lower_slope) %>%
select(STUDY_ID, model, bt_slope, bt_upper, bt_lower)
s2 <- rct_study_estimate %>%
filter(model!='Jne_new_norm' & time_period=='ALL') %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope) %>%
select(STUDY_ID, model, rct_slope, rct_lower, rct_upper)
s3 <- rrt_study_estimate %>%
filter(model!='Jne_rlm_reg_txa') %>%
mutate(rrt_slope = Estimate.cYEAR,
rrt_lower = lower_slope,
rrt_upper = upper_slope) %>%
# need to rename the models so as we can join using model names
mutate(model = ifelse(model=='Jtu_rlm_reg_txa', 'Jtu_new_norm', 'S_pois_new')) %>%
select(STUDY_ID, model, rrt_slope, rrt_lower, rrt_upper)
study_compare <- inner_join(s1, s2, s3,
by = c("STUDY_ID", 'model'))
study_compare %>%
ggplot() +
geom_linerange(aes(x = rct_slope, ymin = bt_lower, ymax = bt_upper, colour = model),
alpha = 0.2, size = .8) +
geom_errorbarh(aes(xmin = rct_lower, xmax = rct_upper, colour = model,
y = bt_slope),
height = 0, alpha = 0.2, size = .8) +
geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
alpha = 0.5,
size = 2,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Study-level slope (RCT model)',
y = 'Study-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
study_compare %>%
ggplot() +
# geom_linerange(aes(x = rct_slope, ymin = bt_lower, ymax = bt_upper, colour = model),
#                alpha = 0.2, size = .8) +
# geom_errorbarh(aes(xmin = rct_lower, xmax = rct_upper, colour = model,
#                    y = bt_slope),
#                height = 0, alpha = 0.2, size = .8) +
# geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
#            alpha = 0.5,
#            size = 2,
#            pch = 19) +
geom_point(aes(x = rrt_slope, y = bt_slope, colour = model),
alpha = 0.5,
size = 2,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Study-level slope (RCT model)',
y = 'Study-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
study_compare
# prepare coefficients for joining
s1 <- BT_study_estimate %>%
filter(model!='Jne_new_norm' & model!='Jtu_beta') %>%
mutate(bt_slope = Estimate.cYEAR,
bt_upper = upper_slope,
bt_lower = lower_slope) %>%
select(Biome, STUDY_ID, model, bt_slope, bt_upper, bt_lower) %>%
inner_join(realm_climate_biome %>%
select(-REALM),
by = 'Biome')
rarefied_medians <- rarefied_medians %>%
group_by(Biome, taxa_mod) %>%
mutate(n_cells = n_distinct(rarefyID)) %>%
ungroup() %>%
filter(n_cells > 3)
#--------rarefied_medians.Rdata for meta data not in model object
load('~/Dropbox/BiogeoBioTIME/rarefied_medians.Rdata')
rarefied_medians <- rarefied_medians %>%
group_by(Biome, taxa_mod) %>%
mutate(n_cells = n_distinct(rarefyID)) %>%
ungroup() %>%
filter(n_cells > 3)
realm_climate_biome <- rarefied_medians %>%
distinct(REALM, climate_mod, Biome) %>%
ungroup()
# want unique climate (latitudinal bands for each biome)
# this is to compare like with like: some of the rct study estimates span multiple latitudinal bands
realm_climate_biome <- realm_climate_biome %>%
# filter(Biome %in% biome_levels_model$Biome) %>%
mutate(climate_mod = ifelse(Biome=='Arctic', 'Polar',
ifelse(Biome=='Boreal_Forests_Taiga', 'Temperate',
ifelse(Biome=='Cold_Temperate_Northeast_Pacific', 'Temperate',
ifelse(Biome=='Continental_High_Antarctic', 'Polar',
ifelse(Biome=='Hawaii', 'Tropical',
ifelse(Biome=='Northern_European_Seas', 'Temperate',
ifelse(Biome=='Subantarctic_Islands', 'Polar',
ifelse(Biome=='Tropical_and_Subtropical_Grasslands_Savannas_and_Shrublands', 'Temperate',
ifelse(Biome=='Tropical_and_Subtropical_Moist_Broadleaf_Forests', 'Tropical',
ifelse(Biome=='Tropical_Northwestern_Atlantic', 'Tropical',
ifelse(Biome=='Northeast_Australian_Shelf', 'Tropical', climate_mod))))))))))))
# wrangle study level estimates
BT_study_estimate <- BT_studyID_estimate %>%
mutate(STUDY_ID2 = str_sub(level, start = -3),
# drop underscores
STUDY_ID = sub('_','', STUDY_ID2),
# remove study
bt = str_remove(level, STUDY_ID2),
# remove trailing underscore
bt = sub('_$', '', bt)) %>%
# ok, now use existing hacky code to separate biome and taxa
separate(bt, c('b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 't'), remove=F, sep='_') %>%
mutate(taxa_mod = ifelse(!is.na(t), t,
ifelse(!is.na(b7), b7,
ifelse(!is.na(b6), b6,
ifelse(!is.na(b5), b5,
ifelse(!is.na(b4), b4,
ifelse(!is.na(b3), b3, b2)))))),
b7 = ifelse(b7==taxa_mod, '', b7),
Biome = ifelse(is.na(b3), b1,
ifelse(is.na(b4), paste(b1, b2, sep='_'),
ifelse(is.na(b5), paste(b1, b2, b3, sep='_'),
ifelse(is.na(b6), paste(b1, b2, b3, b4, sep='_'),
ifelse(is.na(b7), paste(b1, b2, b3, b4, b5, sep='_'),
paste(b1, b2, b3, b4, b5, b6, b7, sep='_'))))))) %>%
select(-b1, -b2, -b3, -b4, -b5, -b6, -b7, -t)
# repeat for realm-climate-taxa model (note different number of studies due to inclusion criteria)
rct_study_estimate <- rlm_clm_txa_studyID_estimate %>%
separate(level, into = c('Realm', 'Climate', 'Taxa', 'STUDY_ID', 'b5' , 'b6'), sep = '_', remove = FALSE) %>%
select(-b5, -b6)
# repeat for realm-region-taxa model (note different number of studies due to inclusion criteria)
rrt_study_estimate <- rrt_studyID_estimate %>%
# separate on the last (rightmost) underscore
separate(level, c('realm_region_taxa', 'STUDY_ID'), sep = '_(?!.*_)',
remove = F)
# prepare coefficients for joining
s1 <- BT_study_estimate %>%
filter(model!='Jne_new_norm' & model!='Jtu_beta') %>%
mutate(bt_slope = Estimate.cYEAR,
bt_upper = upper_slope,
bt_lower = lower_slope) %>%
select(Biome, STUDY_ID, model, bt_slope, bt_upper, bt_lower) %>%
inner_join(realm_climate_biome %>%
select(-REALM),
by = 'Biome')
s2 <- rct_study_estimate %>%
filter(model!='Jne_new_norm' & time_period=='ALL') %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope) %>%
select(STUDY_ID, model, rct_slope, rct_lower, rct_upper)
s3 <- rrt_study_estimate %>%
filter(model!='Jne_rlm_reg_txa') %>%
mutate(rrt_slope = Estimate.cYEAR,
rrt_lower = lower_slope,
rrt_upper = upper_slope) %>%
# need to rename the models so as we can join using model names
mutate(model = ifelse(model=='Jtu_rlm_reg_txa', 'Jtu_new_norm', 'S_pois_new')) %>%
select(STUDY_ID, model, rrt_slope, rrt_lower, rrt_upper)
study_compare <- inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod'))
s2
s2 <- rct_study_estimate %>%
filter(model!='Jne_new_norm' & time_period=='ALL') %>%
mutate(rct_slope = Estimate.cYEAR,
rct_lower = lower_slope,
rct_upper = upper_slope,
climate_mod = Climate) %>%
select(climate_mod, STUDY_ID, model, rct_slope, rct_lower, rct_upper)
study_compare <- inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod'))
study_compare %>%
ggplot() +
geom_linerange(aes(x = rct_slope, ymin = bt_lower, ymax = bt_upper, colour = model),
alpha = 0.2, size = .8) +
geom_errorbarh(aes(xmin = rct_lower, xmax = rct_upper, colour = model,
y = bt_slope),
height = 0, alpha = 0.2, size = .8) +
geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
alpha = 0.5,
size = 2,
pch = 19) +
# geom_point(aes(x = rrt_slope, y = bt_slope, colour = model),
#            alpha = 0.5,
#            size = 2,
#            pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Study-level slope (RCT model)',
y = 'Study-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
study_compare
study_compare <- inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod')) %>%
left_join(s3, by = 'STUDY_ID', 'model')
study_compare
inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod'))
inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod')) %>%
left_join(s3, by = c('STUDY_ID', 'model'))
inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod')) %>%
right_join(s3, by = c('STUDY_ID', 'model'))
inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod')) %>%
inner_join(s3, by = c('STUDY_ID', 'model'))
study_compare <- inner_join(s1, s2,
by = c("STUDY_ID", 'model', 'climate_mod')) %>%
inner_join(s3, by = c('STUDY_ID', 'model'))
study_compare %>%
ggplot() +
# geom_linerange(aes(x = rct_slope, ymin = bt_lower, ymax = bt_upper, colour = model),
#                alpha = 0.2, size = .8) +
# geom_errorbarh(aes(xmin = rct_lower, xmax = rct_upper, colour = model,
#                    y = bt_slope),
#                height = 0, alpha = 0.2, size = .8) +
# geom_point(aes(x = rct_slope, y = bt_slope, colour = model),
#            alpha = 0.5,
#            size = 2,
#            pch = 19) +
geom_point(aes(x = rrt_slope, y = bt_slope, colour = model),
alpha = 0.5,
size = 2,
pch = 19) +
geom_abline(intercept = 0, slope = 1, lty = 2) +
scale_color_manual(values = c('Jtu_new_norm' = '#d8b365',
'S_pois_new' = '#5ab4ac'),
labels = c("Turnover component of\nJaccard's dissimilarity",
"Species richness")
#guide = '', guide argument is broken
) +
labs(x = 'Study-level slope (RCT model)',
y = 'Study-level slope (BT model)') +
theme_bw() +
theme(#panel.grid = element_blank(),
legend.position = c(0.1, 0.9),
legend.title = element_blank())
rrt_study_estimate
